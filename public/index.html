<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a1a1a">
    <title>Mamaphone</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Auth Screen -->
    <div id="auth-screen" class="screen">
        <div class="container">
            <h1>üîä Mamaphone</h1>
            <p>–ê—É–¥–∏–æ-–∑–≤–æ–Ω–∫–∏ –¥–ª—è –±–ª–∏–∑–∫–∏—Ö</p>
            <button id="google-signin-btn" class="btn-google">
                <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M17.6 9.2l-.1-1.8H9v3.4h4.8C13.6 12 13 13 12 13.6v2.2h3a8.8 8.8 0 0 0 2.6-6.6z" fill="#4285F4"/><path d="M9 18c2.4 0 4.5-.8 6-2.2l-3-2.2a5.4 5.4 0 0 1-8-2.9H1V13a9 9 0 0 0 8 5z" fill="#34A853"/><path d="M4 10.7a5.4 5.4 0 0 1 0-3.4V5H1a9 9 0 0 0 0 8l3-2.3z" fill="#FBBC05"/><path d="M9 3.6c1.3 0 2.5.4 3.4 1.3L15 2.3A9 9 0 0 0 1 5l3 2.4a5.4 5.4 0 0 1 5-3.7z" fill="#EA4335"/></g></svg>
                –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
            </button>
        </div>
    </div>

    <!-- Name Setup Screen (first time) -->
    <div id="name-screen" class="screen hidden">
        <div class="container">
            <h2>–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?</h2>
            <input type="text" id="name-input" placeholder="–í–∞—à–µ –∏–º—è" maxlength="30">
            <button id="save-name-btn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- Debug Panel -->
    <div id="debug-panel" class="debug-panel" style="display: none;">
        <div class="debug-header">
            <span>Debug Console</span>
            <button id="debug-close-btn" class="debug-close">‚úï</button>
        </div>
        <div id="debug-logs" class="debug-logs"></div>
    </div>

    <!-- Main Screen -->
    <div id="main-screen" class="screen hidden">
        <header>
            <h1>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h1>
            <div class="header-actions">
                <button id="debug-toggle-btn" class="btn-icon" title="Debug">üêõ</button>
                <button id="share-contact-btn" class="btn-icon" title="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–º">üì§</button>
                <button id="settings-btn" class="btn-icon" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
            </div>
        </header>

        <div class="container">
            <!-- Add Contact Section -->
            <div class="add-contact-section">
                <button id="add-contact-btn" class="btn-secondary">+ –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç</button>
            </div>

            <!-- Contacts List -->
            <div id="contacts-list" class="contacts-list">
                <!-- Contacts will be rendered here -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="empty-state">
                <p>üì± –ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤</p>
                <p class="small">–î–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–∑–µ–π —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–≤–æ–Ω–∏—Ç—å</p>
            </div>
        </div>
    </div>

    <!-- Add Contact Modal -->
    <div id="add-contact-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç</h3>
            <input type="email" id="contact-email-input" placeholder="Email –¥—Ä—É–≥–∞" autocomplete="off">
            <div class="modal-actions">
                <button id="cancel-add-btn" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                <button id="confirm-add-btn" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <p id="add-contact-error" class="error hidden"></p>
        </div>
    </div>

    <!-- Share Contact Modal -->
    <div id="share-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–º</h3>
            <p class="small">–û—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç—É —Å—Å—ã–ª–∫—É –¥—Ä—É–∑—å—è–º:</p>
            <div class="share-link-box">
                <input type="text" id="share-link" readonly>
                <button id="copy-link-btn" class="btn-icon">üìã</button>
            </div>
            <button id="close-share-btn" class="btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            <div class="settings-section">
                <label class="checkbox-label">
                    <input type="checkbox" id="force-turn-checkbox">
                    <span>–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TURN</span>
                </label>
                <p class="small">–î–ª—è –æ—Ç–ª–∞–¥–∫–∏: –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç WebRTC –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ TURN —Å–µ—Ä–≤–µ—Ä—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</p>
            </div>
            <button id="close-settings-btn" class="btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- Incoming Call Screen -->
    <div id="incoming-call-screen" class="screen hidden">
        <div class="container call-container">
            <h2 id="caller-name">–í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫...</h2>
            <div class="call-avatar">üìû</div>
            <div class="call-actions">
                <button id="decline-call-btn" class="btn-danger">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                <button id="accept-call-btn" class="btn-success">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Outgoing Call Screen -->
    <div id="outgoing-call-screen" class="screen hidden">
        <div class="container call-container">
            <h2 id="callee-name">–ó–≤–æ–Ω–∏–º...</h2>
            <div class="call-avatar">üìû</div>
            <button id="cancel-call-btn" class="btn-danger">–û—Ç–º–µ–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- Active Call Screen -->
    <div id="active-call-screen" class="screen hidden">
        <div class="container call-container">
            <h2 id="active-call-name">–ù–∞ —Å–≤—è–∑–∏</h2>
            <div class="call-avatar">üîä</div>
            <div id="call-timer" class="call-timer">00:00</div>
            <div id="connection-indicator" class="connection-indicator" style="display: none;">
                ‚ö™ Connecting...
            </div>
            <div class="call-actions">
                <button id="speaker-toggle-btn" class="btn-secondary">üîá –ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å</button>
                <button id="end-call-btn" class="btn-danger">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Audio element for remote stream -->
    <audio id="remote-audio" autoplay></audio>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/metered-config.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/webrtc.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
